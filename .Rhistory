select(member_casual,month_year,start_station_name) %>%
group_by(member_casual,start_station_name) %>%
summarize(ride_count = n()) %>%
mutate(ride_perc = ifelse(member_casual == "member", ride_count/tally(station_info,member_casual == "member")[[1,1]],
ride_count/tally(station_info,member_casual == "casual")[[1,1]])) %>%
arrange(member_casual, desc(ride_perc)) %>%
group_by(member_casual) %>%
mutate(rank = rank(-ride_perc)) %>%
filter(rank<=5) %>%
ggplot(aes(x=start_station_name, y=ride_perc, fill=member_casual)) + geom_col() +
facet_wrap(~member_casual,scales = "free_x") + aes(stringr::str_wrap(V1, 15), V2) + xlab(NULL) +
ylab(NULL)
station_info %>%
select(member_casual,month_year,start_station_name) %>%
group_by(member_casual,start_station_name) %>%
summarize(ride_count = n()) %>%
mutate(ride_perc = ifelse(member_casual == "member", ride_count/tally(station_info,member_casual == "member")[[1,1]],
ride_count/tally(station_info,member_casual == "casual")[[1,1]])) %>%
arrange(member_casual, desc(ride_perc)) %>%
group_by(member_casual) %>%
mutate(rank = rank(-ride_perc)) %>%
filter(rank<=5) %>%
ggplot(aes(x=start_station_name, y=ride_perc, fill=member_casual)) + geom_col() +
facet_wrap(~member_casual,scales = "free_x") + aes(stringr::str_wrap(start_station_name, 15), V2) + xlab(NULL) +
ylab(ride_perc)
station_info %>%
select(member_casual,month_year,start_station_name) %>%
group_by(member_casual,start_station_name) %>%
summarize(ride_count = n()) %>%
mutate(ride_perc = ifelse(member_casual == "member", ride_count/tally(station_info,member_casual == "member")[[1,1]],
ride_count/tally(station_info,member_casual == "casual")[[1,1]])) %>%
arrange(member_casual, desc(ride_perc)) %>%
group_by(member_casual) %>%
mutate(rank = rank(-ride_perc)) %>%
filter(rank<=5) %>%
ggplot(aes(x=start_station_name, y=ride_perc, fill=member_casual)) + geom_col() +
facet_wrap(~member_casual,scales = "free_x") + aes(stringr::str_wrap(start_station_name, 15), V2) + xlab(NULL) +
ylab(NULL)
station_info %>%
select(member_casual,month_year,start_station_name) %>%
group_by(member_casual,start_station_name) %>%
summarize(ride_count = n()) %>%
mutate(ride_perc = ifelse(member_casual == "member", ride_count/tally(station_info,member_casual == "member")[[1,1]],
ride_count/tally(station_info,member_casual == "casual")[[1,1]])) %>%
arrange(member_casual, desc(ride_perc)) %>%
group_by(member_casual) %>%
mutate(rank = rank(-ride_perc)) %>%
filter(rank<=5) %>%
ggplot(aes(x=start_station_name, y=ride_perc, fill=member_casual)) + geom_col() +
facet_wrap(~member_casual,scales = "free_x") + aes(stringr::str_wrap(start_station_name, 15), ride_perc) + xlab(NULL) +
ylab(NULL)
station_info %>%
select(member_casual,month_year,start_station_name) %>%
group_by(member_casual,start_station_name) %>%
summarize(ride_count = n()) %>%
mutate(ride_perc = ifelse(member_casual == "member", ride_count/tally(station_info,member_casual == "member")[[1,1]],
ride_count/tally(station_info,member_casual == "casual")[[1,1]])) %>%
arrange(member_casual, desc(ride_perc)) %>%
group_by(member_casual) %>%
mutate(rank = rank(-ride_perc)) %>%
filter(rank<=5) %>%
ggplot(aes(x=start_station_name, y=ride_perc, fill=member_casual)) + geom_col() +
facet_wrap(~member_casual,scales = "free_x") + aes(stringr::str_wrap(start_station_name, 15), ride_perc) + xlab(NULL) +
ylab("Percent of rides")
station_info %>%
select(member_casual,month_year,start_station_name) %>%
group_by(member_casual,start_station_name) %>%
summarize(ride_count = n()) %>%
mutate(ride_perc = ifelse(member_casual == "member", 100*ride_count/tally(station_info,member_casual == "member")[[1,1]],
100*ride_count/tally(station_info,member_casual == "casual")[[1,1]])) %>%
arrange(member_casual, desc(ride_perc)) %>%
group_by(member_casual) %>%
mutate(rank = rank(-ride_perc)) %>%
filter(rank<=5) %>%
ggplot(aes(x=start_station_name, y=ride_perc, fill=member_casual)) + geom_col() +
facet_wrap(~member_casual,scales = "free_x") + aes(stringr::str_wrap(start_station_name, 15), ride_perc) + xlab(NULL) +
ylab("Percent of rides")
station_info %>%
select(member_casual,month_year,start_station_name) %>%
group_by(member_casual,start_station_name) %>%
summarize(ride_count = n()) %>%
mutate(ride_perc = ifelse(member_casual == "member", 100*ride_count/tally(station_info,member_casual == "member")[[1,1]],
100*ride_count/tally(station_info,member_casual == "casual")[[1,1]])) %>%
arrange(member_casual, desc(ride_perc)) %>%
group_by(member_casual) %>%
mutate(rank = rank(-ride_perc)) %>%
filter(rank<=5) %>%
ggplot(aes(x=start_station_name, y=ride_perc, fill=member_casual)) + geom_col() +
facet_wrap(~member_casual,scales = "free_x") + aes(stringr::str_wrap(start_station_name, 15), ride_perc) +
xlab(NULL) + ylab("Percentage of total rides") + ggtitle("Top 5 stations") +
labs(fill="Member type") + theme(legend.title = element_text(colour = "steelblue", face = "bold.italic", family = "Helvetica")
facet_wrap(~member_casual,scales = "free_x") + aes(stringr::str_wrap(start_station_name, 15), V2) + xlab(NULL) +xs
station_info %>%
select(member_casual,month_year,start_station_name) %>%
group_by(member_casual,start_station_name) %>%
summarize(ride_count = n()) %>%
mutate(ride_perc = ifelse(member_casual == "member", 100*ride_count/tally(station_info,member_casual == "member")[[1,1]],
100*ride_count/tally(station_info,member_casual == "casual")[[1,1]])) %>%
arrange(member_casual, desc(ride_perc)) %>%
group_by(member_casual) %>%
mutate(rank = rank(-ride_perc)) %>%
filter(rank<=5) %>%
ggplot(aes(x=start_station_name, y=ride_perc, fill=member_casual)) + geom_col() +
facet_wrap(~member_casual,scales = "free_x") + aes(stringr::str_wrap(start_station_name, 15), ride_perc) +
xlab(NULL) + ylab("Percentage of total rides") + ggtitle("Top 5 stations") +
labs(fill="Member type") + theme(legend.title = element_text(colour = "steelblue", face = "bold.italic", family = "Helvetica"))
station_info %>%
select(member_casual,month_year,start_station_name) %>%
group_by(member_casual,start_station_name) %>%
summarize(ride_count = n()) %>%
mutate(ride_perc = ifelse(member_casual == "member", 100*ride_count/tally(station_info,member_casual == "member")[[1,1]],
100*ride_count/tally(station_info,member_casual == "casual")[[1,1]])) %>%
arrange(member_casual, desc(ride_perc)) %>%
group_by(member_casual) %>%
mutate(rank = rank(-ride_perc)) %>%
filter(rank<=5) %>%
ggplot(aes(x=start_station_name, y=ride_perc, fill=member_casual)) + geom_col() +
facet_wrap(~member_casual,scales = "free_x") + aes(stringr::str_wrap(start_station_name, 15), ride_perc) +
xlab(NULL) + ylab("Percentage of total rides") + ggtitle("Top 5 stations") +
labs(fill="Member type") + theme(legend.title = element_text(colour = "steelblue", face = "bold.italic", family = "Courier"))
station_info %>%
select(member_casual,month_year,start_station_name) %>%
group_by(member_casual,start_station_name) %>%
summarize(ride_count = n()) %>%
mutate(ride_perc = ifelse(member_casual == "member", 100*ride_count/tally(station_info,member_casual == "member")[[1,1]],
100*ride_count/tally(station_info,member_casual == "casual")[[1,1]])) %>%
arrange(member_casual, desc(ride_perc)) %>%
group_by(member_casual) %>%
mutate(rank = rank(-ride_perc)) %>%
filter(rank<=5) %>%
ggplot(aes(x=start_station_name, y=ride_perc, fill=member_casual)) + geom_col() +
facet_wrap(~member_casual,scales = "free_x", labeller = labeller(member_casual = c("Casual","Annual Member"))) + aes(stringr::str_wrap(start_station_name, 15), ride_perc) +
xlab(NULL) + ylab("Percentage of total rides") + ggtitle("Top 5 stations") +
labs(fill="Member type") + theme(legend.title = element_text(colour = "steelblue", face = "bold.italic", family = "Courier"))
station_info %>%
select(member_casual,month_year,start_station_name) %>%
group_by(member_casual,start_station_name) %>%
summarize(ride_count = n()) %>%
mutate(ride_perc = ifelse(member_casual == "member", 100*ride_count/tally(station_info,member_casual == "member")[[1,1]],
100*ride_count/tally(station_info,member_casual == "casual")[[1,1]])) %>%
arrange(member_casual, desc(ride_perc)) %>%
group_by(member_casual) %>%
mutate(rank = rank(-ride_perc)) %>%
filter(rank<=5) %>%
ggplot(aes(x=start_station_name, y=ride_perc, fill=member_casual)) + geom_col() +
facet_wrap(~member_casual,scales = "free_x", labeller = labeller(member_casual = list("casual"="Casual","member"="Annual Member"))) + aes(stringr::str_wrap(start_station_name, 15), ride_perc) +
xlab(NULL) + ylab("Percentage of total rides") + ggtitle("Top 5 stations") +
labs(fill="Member type") + theme(legend.title = element_text(colour = "steelblue", face = "bold.italic", family = "Courier"))
f <- function(x, y) {
if (x == "member")
c(y[-length(y)], "Total")
else
y
}
station_info %>%
select(member_casual,month_year,start_station_name) %>%
group_by(member_casual,start_station_name) %>%
summarize(ride_count = n()) %>%
mutate(ride_perc = ifelse(member_casual == "member", 100*ride_count/tally(station_info,member_casual == "member")[[1,1]],
100*ride_count/tally(station_info,member_casual == "casual")[[1,1]])) %>%
arrange(member_casual, desc(ride_perc)) %>%
group_by(member_casual) %>%
mutate(rank = rank(-ride_perc)) %>%
filter(rank<=5) %>%
ggplot(aes(x=start_station_name, y=ride_perc, fill=member_casual)) + geom_col() +
facet_wrap(~member_casual,scales = "free_x", labeller = f) + aes(stringr::str_wrap(start_station_name, 15), ride_perc) +
xlab(NULL) + ylab("Percentage of total rides") + ggtitle("Top 5 stations") +
labs(fill="Member type") + theme(legend.title = element_text(colour = "steelblue", face = "bold.italic", family = "Courier"))
member_names <- list(
"casual" = "Casual",
"member" = "Annual Member"
)
member_labeller <- function(x, y) {
return(member_names[y])
}
station_info %>%
select(member_casual,month_year,start_station_name) %>%
group_by(member_casual,start_station_name) %>%
summarize(ride_count = n()) %>%
mutate(ride_perc = ifelse(member_casual == "member", 100*ride_count/tally(station_info,member_casual == "member")[[1,1]],
100*ride_count/tally(station_info,member_casual == "casual")[[1,1]])) %>%
arrange(member_casual, desc(ride_perc)) %>%
group_by(member_casual) %>%
mutate(rank = rank(-ride_perc)) %>%
filter(rank<=5) %>%
ggplot(aes(x=start_station_name, y=ride_perc, fill=member_casual)) + geom_col() +
facet_wrap(~member_casual,scales = "free_x", labeller = member_labeller) +
aes(stringr::str_wrap(start_station_name, 15), ride_perc) + xlab(NULL) +
ylab("Percentage of total rides") + ggtitle("Top 5 stations") + labs(fill="Member type") +
theme(legend.title = element_text(colour = "steelblue", face = "bold.italic", family = "Courier"))
member_names["casual"]
member_names["casual"]
member_names["member"]
station_info %>%
select(member_casual,month_year,start_station_name) %>%
group_by(member_casual,start_station_name) %>%
summarize(ride_count = n()) %>%
mutate(ride_perc = ifelse(member_casual == "member", 100*ride_count/tally(station_info,member_casual == "member")[[1,1]],
100*ride_count/tally(station_info,member_casual == "casual")[[1,1]])) %>%
arrange(member_casual, desc(ride_perc)) %>%
group_by(member_casual) %>%
mutate(rank = rank(-ride_perc)) %>%
filter(rank<=5) %>%
ggplot(aes(x=start_station_name, y=ride_perc, fill=member_casual)) + geom_col() +
facet_wrap(~member_casual,scales = "free_x", labeller = member_labeller) +
aes(stringr::str_wrap(start_station_name, 15), ride_perc) + xlab(NULL) + stat_bin(aes(n=nrow(h3),y=..count../n), binwidth=10) +
ylab("Percentage of total rides") + ggtitle("Top 5 stations") + labs(fill="Member type") +
theme(legend.title = element_text(colour = "steelblue", face = "bold.italic", family = "Courier"))
station_info %>%
select(member_casual,month_year,start_station_name) %>%
group_by(member_casual,start_station_name) %>%
summarize(ride_count = n()) %>%
mutate(ride_perc = ifelse(member_casual == "member", 100*ride_count/tally(station_info,member_casual == "member")[[1,1]],
100*ride_count/tally(station_info,member_casual == "casual")[[1,1]])) %>%
arrange(member_casual, desc(ride_perc)) %>%
group_by(member_casual) %>%
mutate(rank = rank(-ride_perc)) %>%
filter(rank<=5) %>%
ggplot(aes(x=start_station_name, y=ride_perc, fill=member_casual)) + geom_col() +
facet_wrap(~member_casual,scales = "free_x", labeller = member_labeller) +
aes(stringr::str_wrap(start_station_name, 15), ride_perc) + xlab(NULL) +
ylab("Percentage of total rides") + ggtitle("Top 5 stations") + labs(fill="Member type") +
theme(legend.title = element_text(colour = "steelblue", face = "bold.italic", family = "Courier"))
station_info %>%
select(member_casual,month_year,start_station_name) %>%
group_by(member_casual,start_station_name) %>%
summarize(ride_count = n()) %>%
mutate(ride_perc = ifelse(member_casual == "member", 100*ride_count/tally(station_info,member_casual == "member")[[1,1]],
100*ride_count/tally(station_info,member_casual == "casual")[[1,1]])) %>%
arrange(member_casual, desc(ride_perc)) %>%
group_by(member_casual) %>%
mutate(rank = rank(-ride_perc)) %>%
filter(rank<=5) %>%
ggplot(aes(x=start_station_name, y=ride_perc, fill=member_casual)) + geom_col() +
facet_wrap(~member_casual,scales = "free_x", labeller = as_labeller(member_names) +
aes(stringr::str_wrap(start_station_name, 15), ride_perc) + xlab(NULL) +
ylab("Percentage of total rides") + ggtitle("Top 5 stations") + labs(fill="Member type") +
theme(legend.title = element_text(colour = "steelblue", face = "bold.italic", family = "Courier"))
kl
station_info %>%
select(member_casual,month_year,start_station_name) %>%
group_by(member_casual,start_station_name) %>%
summarize(ride_count = n()) %>%
mutate(ride_perc = ifelse(member_casual == "member", 100*ride_count/tally(station_info,member_casual == "member")[[1,1]],
100*ride_count/tally(station_info,member_casual == "casual")[[1,1]])) %>%
arrange(member_casual, desc(ride_perc)) %>%
group_by(member_casual) %>%
mutate(rank = rank(-ride_perc)) %>%
filter(rank<=5) %>%
ggplot(aes(x=start_station_name, y=ride_perc, fill=member_casual)) + geom_col() +
facet_wrap(~member_casual,scales = "free_x", labeller = as_labeller(member_names)) +
aes(stringr::str_wrap(start_station_name, 15), ride_perc) + xlab(NULL) +
ylab("Percentage of total rides") + ggtitle("Top 5 stations") + labs(fill="Member type") +
theme(legend.title = element_text(colour = "steelblue", face = "bold.italic", family = "Courier"))
member_names <- c(
`casual` = "Casual",
`member` = "Annual Member"
)
station_info %>%
select(member_casual,month_year,start_station_name) %>%
group_by(member_casual,start_station_name) %>%
summarize(ride_count = n()) %>%
mutate(ride_perc = ifelse(member_casual == "member", 100*ride_count/tally(station_info,member_casual == "member")[[1,1]],
100*ride_count/tally(station_info,member_casual == "casual")[[1,1]])) %>%
arrange(member_casual, desc(ride_perc)) %>%
group_by(member_casual) %>%
mutate(rank = rank(-ride_perc)) %>%
filter(rank<=5) %>%
ggplot(aes(x=start_station_name, y=ride_perc, fill=member_casual)) + geom_col() +
facet_wrap(~member_casual,scales = "free_x", labeller = as_labeller(member_names)) +
aes(stringr::str_wrap(start_station_name, 15), ride_perc) + xlab(NULL) +
ylab("Percentage of total rides") + ggtitle("Top 5 stations") + labs(fill="Member type")
View(distance_info)
station_heatmap <-
trips %>%
select(member_casual,started_at,start_station_name,start_station_id,rideable_type,start_loc_text) %>%
filter(!is.na(start_station_name)) %>%
filter(!is.na(start_loc_text)) %>%
collect()
write.csv(station_heatmap,"station_heatmap.csv")
distance_info %>%
filter(distance_m > 0) %>%
group_by(month_year,member_casual) %>%
summarise(average_dist = mean(distance_m)) %>%
ggplot() + geom_col(aes(x=month_year,y=average_dist,fill=member_casual),position = 'dodge') +
labs(fill="Member Type", x="Month", y="Distance from start to end station")
#Slightly higher distance for casual members, but nothing significant, see Graph
#Storing total number of rides for each type of user
casual_count = tally(distance_info,member_casual == "casual")[[1,1]]
member_count = tally(distance_info, member_casual == "member")[[1,1]]
distance_info %>%
filter(distance_m > 0) %>%
group_by(month_year,member_casual) %>%
summarise(average_dist = mean(distance_m)) %>%
ggplot() + geom_col(aes(x=month_year,y=average_dist,fill=member_casual),position = 'dodge') +
labs(fill="Member Type", x="Month", y="Distance from start to end station")
distance_info %>%
select(member_casual, month_year, rideable_type) %>%
group_by(rideable_type,member_casual) %>%
summarise(bike_count = n()) %>%
mutate(bike_count = ifelse (member_casual == "member", 100*bike_count/tally(distance_info, member_casual == "member")[[1,1]],
100*bike_count/tally(distance_info,member_casual == "casual")[[1,1]])) %>%
ggplot() + geom_bar(aes(x="",y=bike_count,fill=rideable_type),stat="identity", width=1) +
coord_polar("y", start=0) + facet_wrap(~member_casual)
distance_info %>%
select(member_casual, month_year, rideable_type) %>%
group_by(rideable_type,member_casual) %>%
summarise(bike_count = n()) %>%
mutate(bike_count = ifelse (member_casual == "member", 100*bike_count/tally(distance_info, member_casual == "member")[[1,1]],
100*bike_count/tally(distance_info,member_casual == "casual")[[1,1]])) %>%
mutate(rideable_type = ifelse(rideable_type == "docked_bike", "electric_bike", rideable_type)) %>%
ggplot() + geom_bar(aes(x="",y=bike_count,fill=rideable_type),stat="identity", width=1) +
coord_polar("y", start=0) + facet_wrap(~member_casual)
library(bigrquery)
library(tidyverse)
library(wk)
library(lubridate)
Sys.setlocale("LC_TIME", "English")
head(station_heatmap)
head(station_heatmap)
str_split("45,58",',')
str_split("45,58",',')[1]
str_split("45,58",',')[[1,1]]
str_split("45,58",',')[1,1]
str_split("45,58",',')[1]
str_split("45,58",',')[[1]]
str_split("45,58",',')[[[1]]]
str_split("45,58",',')[[1]]
str_split("45,58",',')[[2]]
str_split("45,58",',')[[1,1]]
str_split("45,58",',')[[0,1]]
str_split("45,58",',')[[1]][1]
as_numeric(str_split("45,58",',')[[1]][1])
as.numeric(str_split("45,58",',')[[1]][1])
as.numeric("545645.8456")
as.double("65465653.5646546")
x = as.numeric("1.65656565")
x*2
as.numeric(str_split("45,58",',')[[1]][2])
station_heatmap <-
station_heatmap %>%
mutate(Latitude = as.numeric(str_split(start_loc_text,",")[[1,1]][1]),
Longitude = as.numeric(str_split(start_loc_text,",")[[1,1]][2])) %>%
mutate(month_year = factor(format(started_at, "%b-%y"), levels =
c("May-21","Jun-21","Jul-21","Aug-21","Sep-21","Oct-21","Nov-21","Dec-21","Jan-22","Feb-22","Mar-22","Apr-22")))
station_heatmap <-
station_heatmap %>%
mutate(Latitude = as.numeric(str_split(start_loc_text,",")[[1]][1]),
Longitude = as.numeric(str_split(start_loc_text,",")[[1]][2])) %>%
mutate(month_year = factor(format(started_at, "%b-%y"), levels =
c("May-21","Jun-21","Jul-21","Aug-21","Sep-21","Oct-21","Nov-21","Dec-21","Jan-22","Feb-22","Mar-22","Apr-22")))
head(station_heatmap)
station_heatmap %>%
group_by (member_casual,start_station_id,month_year)
station_heatmap %>%
select(member_casual,start_station_name,start_station_id, rideable_type, Latitude, Longitude, month_year)
group_by (member_casual,start_station_id,month_year)
station_heatmap %>%
select(member_casual,start_station_name,start_station_id, rideable_type, Latitude, Longitude, month_year) %>%
group_by (member_casual,start_station_id,month_year)
station_heatmap %>%
select(member_casual,start_station_name,start_station_id, rideable_type, Latitude, Longitude, month_year) %>%
group_by (member_casual,start_station_id,month_year) %>%
summarize(rides = n())
heatmap_export <-
station_heatmap %>%
select(member_casual,start_station_name,start_station_id, rideable_type, Latitude, Longitude, month_year) %>%
group_by (member_casual,start_station_id,month_year) %>%
summarize(rides = n())
heatmap_export <-
station_heatmap %>%
select(member_casual,start_station_name,start_station_id, rideable_type, Latitude, Longitude, month_year) %>%
group_by (member_casual,start_station_id,start_station_name, Latitude, Longitude, month_year) %>%
summarize(rides = n())
View(heatmap_export)
View(station_heatmap)
View(station_heatmap)
View(station_heatmap)
station_heatmap <-
trips %>%
select(member_casual,started_at,start_station_name,start_station_id,rideable_type,start_loc_text) %>%
filter(!is.na(start_station_name)) %>%
filter(!is.na(start_loc_text)) %>%
collect () %>%
mutate(Latitude = as.numeric(str_split(start_loc_text,",")[[1]][1]),
Longitude = as.numeric(str_split(start_loc_text,",")[[1]][2])) %>%
mutate(month_year = factor(format(started_at, "%b-%y"), levels =
c("May-21","Jun-21","Jul-21","Aug-21","Sep-21","Oct-21","Nov-21","Dec-21","Jan-22","Feb-22","Mar-22","Apr-22")))
View(station_heatmap)
station_heatmap <-
mutate(Latitude = as.numeric(str_split(start_loc_text,",")[1]),
Longitude = as.numeric(str_split(start_loc_text,",")[2]))
station_heatmap %>%
mutate(Latitude = as.numeric(str_split(start_loc_text,",")[1]),
Longitude = as.numeric(str_split(start_loc_text,",")[2]))
station_heatmap %>% mutate(Latitude = as.numeric(str_split(start_loc_text,",")[1]),
+        Longitude = as.numeric(str_split(start_loc_text,",")[2]))
station_heatmap Ã¹
station_heatmap %>%
rowwise() %>%
mutate(Latitude = as.numeric(str_split(start_loc_text,",")[[1,1]][1]),
Longitude = as.numeric(str_split(start_loc_text,",")[[1,1]][2]))
station_heatmap %>%
rowwise() %>%
mutate(Latitude = as.numeric(str_split(start_loc_text,",")[[1]][1]),
Longitude = as.numeric(str_split(start_loc_text,",")[[1]][2]))
eds
sdql
fl;d
station_heatmap <-
station_heatmap %>%
rowwise() %>%
mutate(Latitude = as.numeric(str_split(start_loc_text,",")[[1]][1]),
Longitude = as.numeric(str_split(start_loc_text,",")[[1]][2]))
View(station_heatmap)
heatmap_export <-
station_heatmap %>%
select(member_casual,start_station_name,start_station_id, rideable_type, Latitude, Longitude, month_year) %>%
group_by (member_casual,start_station_id,start_station_name, Latitude, Longitude, month_year) %>%
summarize(rides = n())
heatmap_export <-
station_heatmap %>%
select(member_casual,start_station_name,start_station_id, rideable_type, Latitude, Longitude, month_year) %>%
group_by (member_casual,start_station_id,start_station_name, Latitude, Longitude, month_year) %>%
summarize(rides = n()) %>%
distinct(start_station_id, month_year, member_casual)
heatmap_export <-
station_heatmap %>%
select(member_casual,start_station_name,start_station_id, rideable_type, Latitude, Longitude, month_year) %>%
group_by (member_casual,start_station_id,start_station_name, Latitude, Longitude, month_year) %>%
summarize(rides = n())
heatmap_export <-
station_heatmap %>%
select(member_casual,start_station_name,start_station_id, rideable_type, Latitude, Longitude, month_year) %>%
group_by (member_casual,start_station_id,start_station_name) %>%
summarize(rides = n())
heatmap_export <-
station_heatmap %>%
select(member_casual,start_station_name,start_station_id, rideable_type, Latitude, Longitude, month_year) %>%
group_by (member_casual,start_station_id,start_station_name,month_year) %>%
summarize(rides = n())
station_info <- tbl(con,"trips") %>% collect()
station_info <- tbl(con,"station_info")
library(bigrquery)
library(tidyverse)
library(wk)
library(lubridate)
Sys.setlocale("LC_TIME", "English")
station_info <- tbl(con,"station_info") %>% collect()
station_info <- tbl(con,"station_info") %>% collect()
View(heatmap_export)
heatmap_final <-
heatmap_export %>%
left_join(station_info,by="station_id")
View(station_info)
View(heatmap_export)
heatmap_final <-
heatmap_export %>%
setNames("start_station_id","station_id") %>%
left_join(station_info,by="station_id")
heatmap_final <-
heatmap_export %>%
setnames("start_station_id","station_id") %>%
left_join(station_info,by="station_id")
heatmap_final <-
heatmap_export %>%
set_names("start_station_id","station_id") %>%
left_join(station_info,by="station_id")
View(heatmap_export)
View(heatmap_export)
heatmap_export <-
station_heatmap %>%
select(member_casual,start_station_id, month_year) %>%
group_by (member_casual,start_station_id,month_year) %>%
summarize(rides = n())
View(distance_info)
View(heatmap_export)
heatmap_final <-
heatmap_export %>%
set_colnames(c("Member type","station_id","month_year","rides")) %>%
full_join(station_info,by="station_id")
heatmap_final <-
heatmap_export %>%
setNames(c("Member type","station_id","month_year","rides")) %>%
full_join(station_info,by="station_id")
View(heatmap_final)
write.csv(heatmap_final,"heatmap_final.csv")
heatmap_export %>%
summarize(rides=n())
library(bigrquery)
library(tidyverse)
library(wk)
library(lubridate)
Sys.setlocale("LC_TIME", "English")
heatmap_export %>%
summarize(n())
heatmap_export %>%
group_by(member_casual) %>%
sum(n())
heatmap_export %>%
group_by(member_casual) %>%
summarize(n())
heatmap_export %>%
group_by(member_casual) %>%
summarize(sum(n()))
summarize(sum(rides))
heatmap_export %>%
group_by(member_casual) %>%
summarize(sum(rides))
heatmap_final %>% summarize(sum(rides))
heatmap_final %>% group_by(`Member Type`) %>% summarize(sum(rides))
heatmap_final %>% group_by(`Member type`) %>% summarize(sum(rides))
